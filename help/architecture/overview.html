<!DOCTYPE html>
<html lang="zh" data-theme="light">
<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">


<title>架构概览 | Friday 帮助文档</title>


<meta name="description" content="">
<link rel="canonical" href="/architecture/overview.html">

<!-- Meta Tags --><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Friday 帮助文档",
    
    "url": "/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "MDFriday",
  "url": "/",
   "description": "Turn markdown to website, in minutes.",
   "vision": "Make site generation easy and accessible for everyone.",
   "logo": "https://gohugo.net/mdfriday.svg",
   "address": "Cang long Street, Wuhan, China",
   "email": "support@mdfriday.com",
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "/architecture/overview.html",
          "name": "架构概览"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "MDFriday"
  },
  "headline": "架构概览",
  "description" : "Friday 插件采用模块化、分层的架构设计，确保代码的可维护性、可扩展性和高性能。本文档提供对 Friday 核心架构的全面概览。
系统架构总览
graph TB subgraph...",
  "inLanguage" : "zh",
  "wordCount": 2023,
  "datePublished" : "Tue Feb 10 2026 08:00:00 GMT+0800 (China Standard Time)",
  "dateModified" : "Tue Feb 10 2026 08:00:00 GMT+0800 (China Standard Time)",
  "image" : "/",
  "keywords" : [ "架构, 技术" ],
  "mainEntityOfPage" : "/architecture/overview.html",
  "publisher" : {
    "@type": "Organization",
    "name" : "/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "/",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>


<meta property="og:title" content="架构概览" />
<meta property="og:url" content="/architecture/overview.html" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Friday 帮助文档" />

  <meta name="twitter:title" content="架构概览" />
  <meta name="twitter:card" content="summary_large_image" />




<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">



<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Schibsted+Grotesk:ital,wght@0,400;0,700;1,400;1,700&family=Source+Sans+Pro:ital,wght@0,400;0,600;1,400;1,600&family=IBM+Plex+Mono:ital,wght@0,400;0,600;1,400;1,600&display=swap">


<link rel="stylesheet" href="/css/quartz.css">
<link rel="stylesheet" href="/css/clipboard.css">
<link rel="stylesheet" href="/css/callout.css">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" crossorigin="anonymous"></script>
<script defer src="/js/katex-render.js"></script>


<script type="module" defer src="/js/mermaid-render.js"></script>


<meta name="theme-color" content="#faf8f8" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#161618" media="(prefers-color-scheme: dark)">


<script>
(function() {
    const savedTheme = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const theme = savedTheme || (prefersDark ? 'dark' : 'light');
    document.documentElement.dataset.theme = theme;
})();
</script>

</head>
<body>
    
    
    <div class="page">
        <div id="quartz-body">
            
            <aside class="sidebar left"><h1 class="page-title">
    <a href="/index.html">Friday 帮助文档</a>
</h1>

<div class="spacer mobile-only"></div>


                <div class="flex-component" style="display: flex; flex-direction: row; gap: 0.5rem; align-items: center;">
                    
                    <div style="flex-grow: 1; flex-shrink: 1; min-width: 0;">
<div class="search">
    <button class="search-button" aria-label="Search">
        <svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7">
            <title>Search</title>
            <g class="search-path" fill="none">
                <path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4" />
                <circle cx="8" cy="8" r="7" />
            </g>
        </svg>
        <p>搜索</p>
    </button>
    <div class="search-container">
        <div class="search-space">
            <input
                autocomplete="off"
                class="search-bar"
                name="search"
                type="text"
                aria-label="搜索内容..."
                placeholder="搜索内容..."
            />
            <div class="search-layout" data-preview="true"></div>
        </div>
    </div>
</div>

</div>
                    
                    <div style="flex-grow: 0; flex-shrink: 0;"><div class="darkmode">
    <button 
        id="darkmode-toggle" 
        class="darkmode-toggle"
        aria-label="Toggle dark mode"
        title="Toggle dark mode">
        <svg class="sun-icon" width="18" height="18" viewBox="0 0 20 20" fill="none">
            <circle cx="10" cy="10" r="3" fill="currentColor"/>
            <line x1="10" y1="2" x2="10" y2="4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="10" y1="16" x2="10" y2="18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="2" y1="10" x2="4" y2="10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="16" y1="10" x2="18" y2="10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="4.34" y1="4.34" x2="5.76" y2="5.76" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="14.24" y1="14.24" x2="15.66" y2="15.66" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="4.34" y1="15.66" x2="5.76" y2="14.24" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="14.24" y1="5.76" x2="15.66" y2="4.34" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
        <svg class="moon-icon" width="18" height="18" viewBox="0 0 20 20" fill="none" style="display: none;">
            <path d="M17.5 11.5A7.5 7.5 0 0 1 9 3.5c0-.5.1-1 .2-1.5A8.5 8.5 0 1 0 18.5 11c-.5.1-1 .2-1.5.2-.2 0-.3 0-.5.3z" fill="currentColor"/>
        </svg>
    </button>
</div>

</div>
                    <div style="flex-grow: 0; flex-shrink: 0;">
<button class="readermode" aria-label="阅读模式" title="阅读模式">
    <svg
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        version="1.1"
        class="readerIcon"
        fill="currentColor"
        stroke="currentColor"
        stroke-width="0.2"
        stroke-linecap="round"
        stroke-linejoin="round"
        width="64px"
        height="64px"
        viewBox="0 0 24 24">
        <title>阅读模式</title>
        <g transform="translate(-1.8, -1.8) scale(1.15, 1.2)">
            <path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z" />
        </g>
    </svg>
</button>

</div></div><div class="explorer" 
     data-behavior="link" 
     data-collapsed="collapsed" 
     data-savestate="true">
    
    
    <button type="button" 
            class="explorer-toggle mobile-explorer hide-until-loaded" 
            data-mobile="true"
            aria-controls="explorer-content"
            aria-label="切换文件浏览器">
        <svg xmlns="http://www.w3.org/2000/svg" 
             width="24" 
             height="24" 
             viewBox="0 0 24 24" 
             stroke-width="2" 
             stroke="currentColor"
             fill="none"
             stroke-linecap="round" 
             stroke-linejoin="round" 
             class="lucide-menu">
            <line x1="4" x2="20" y1="12" y2="12" />
            <line x1="4" x2="20" y1="6" y2="6" />
            <line x1="4" x2="20" y1="18" y2="18" />
        </svg>
    </button>
    
    
    <button type="button" 
            class="title-button explorer-toggle desktop-explorer" 
            data-mobile="false"
            aria-expanded="true"
            aria-label="切换文件浏览器">
        <h2>文件浏览器</h2>
        <svg xmlns="http://www.w3.org/2000/svg" 
             width="14" 
             height="14" 
             viewBox="5 8 14 8" 
             fill="none" 
             stroke="currentColor" 
             stroke-width="2" 
             stroke-linecap="round" 
             stroke-linejoin="round" 
             class="fold">
            <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
    </button>
    
    
    <div id="explorer-content" 
         class="explorer-content" 
         aria-expanded="false" 
         role="group">
        <ul class="explorer-ul"></ul>
    </div>
    
    
    <template id="template-file">
        <li>
            <a href="#"></a>
        </li>
    </template>
    
    <template id="template-folder">
        <li>
            <div class="folder-container">
                <svg xmlns="http://www.w3.org/2000/svg" 
                     width="12" 
                     height="12" 
                     viewBox="5 8 14 8" 
                     fill="none" 
                     stroke="currentColor" 
                     stroke-width="2" 
                     stroke-linecap="round" 
                     stroke-linejoin="round" 
                     class="folder-icon">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
                <div>
                    <button class="folder-button">
                        <span class="folder-title"></span>
                    </button>
                </div>
            </div>
            <div class="folder-outer">
                <ul class="content"></ul>
            </div>
        </li>
    </template>
</div>

</aside>
            
            
            <div class="center">
                <div class="page-header">
                    
                    <div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs">
    <ul class="breadcrumbs">
        
        <li class="breadcrumb-element">
            <a href="/index.html">Home</a>
            <p aria-hidden="true"> ❯ </p>
        </li>
        
        
                <li class="breadcrumb-element">
                    <a href="/architecture/">Architecture</a>
                    <p aria-hidden="true"> ❯ </p>
                </li>
                <li class="breadcrumb-element">
                    <a href="/architecture/overview.html">架构概览</a>
                </li></ul>
</nav></div>
                </div>
<article class="popover-hint">
    <header class="article-header"><h1 class="article-title">
    架构概览
</h1>

<div class="content-meta">
    <span class="content-meta-date">
        <time datetime="2/10/2026">
            2/10/2026
        </time>
    </span><span class="content-meta-reading-time">
        11 分钟阅读
    </span></div>

<ul class="tags"><li>
        <a href="/tags/架构/index.html" class="internal tag-link">
            架构
        </a>
    </li><li>
        <a href="/tags/技术/index.html" class="internal tag-link">
            技术
        </a>
    </li></ul></header>
    
    <div class="article-content">
        <p>Friday 插件采用模块化、分层的架构设计，确保代码的可维护性、可扩展性和高性能。本文档提供对 Friday 核心架构的全面概览。</p>
<h2 id="系统架构总览">系统架构总览</h2>
<pre class="mermaid-wrapper"><code class="language-mermaid mermaid">graph TB
    subgraph "用户界面层"
        UI[Obsidian UI]
        StatusBar[状态栏]
        Settings[设置面板]
        Commands[命令面板]
    end
    
    subgraph "插件层 (Friday Plugin)"
        PluginMain[FridayPlugin Main]
        SyncCore[FridaySyncCore]
        PublishCore[FridayPublishCore]
    end
    
    subgraph "同步核心层"
        Replicator[LiveSyncReplicator]
        LocalDB[LocalDB Manager]
        StorageEventMgr[StorageEventManager]
        ServerChecker[ServerConnectivityChecker]
    end
    
    subgraph "功能模块层"
        NetworkMgr[NetworkManager]
        OfflineTracker[OfflineTracker]
        ConnectionMonitor[ConnectionMonitor]
        EncryptionMgr[EncryptionManager]
    end
    
    subgraph "存储层"
        PouchDB[(PouchDB&#x3C;br/>IndexedDB)]
        CouchDB[(CouchDB&#x3C;br/>Remote)]
        FileSystem[File System]
    end
    
    UI --> PluginMain
    StatusBar --> PluginMain
    Settings --> PluginMain
    Commands --> PluginMain
    
    PluginMain --> SyncCore
    PluginMain --> PublishCore
    
    SyncCore --> Replicator
    SyncCore --> LocalDB
    SyncCore --> StorageEventMgr
    SyncCore --> ServerChecker
    
    Replicator --> NetworkMgr
    Replicator --> OfflineTracker
    Replicator --> ConnectionMonitor
    Replicator --> EncryptionMgr
    
    LocalDB --> PouchDB
    Replicator --> PouchDB
    Replicator --> CouchDB
    StorageEventMgr --> FileSystem
    
    PouchDB -.双向同步.-> CouchDB
</code><button class="expand-button" aria-label="Expand diagram"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"></path></svg></button><div id="mermaid-container"><div id="mermaid-space"><div class="mermaid-content"></div></div></div></pre>
<h2 id="分层架构">分层架构</h2>
<p>Friday 采用经典的分层架构，从上到下依次为：</p>
<h3 id="1-用户界面层-presentation-layer">1. 用户界面层 (Presentation Layer)</h3>
<p>负责与用户交互，显示状态和接收命令。</p>
<table>
<thead>
<tr>
<th>组件</th>
<th>职责</th>
<th>文件路径</th>
</tr>
</thead>
<tbody>
<tr>
<td>设置面板</td>
<td>配置 License、服务器、加密等</td>
<td><code>src/ui/SettingTab.ts</code></td>
</tr>
<tr>
<td>状态栏</td>
<td>显示同步状态、点击触发同步</td>
<td><code>src/ui/StatusBar.ts</code></td>
</tr>
<tr>
<td>命令面板</td>
<td>提供快捷命令（同步、发布等）</td>
<td><code>src/ui/Commands.ts</code></td>
</tr>
<tr>
<td>通知系统</td>
<td>显示成功/错误消息</td>
<td><code>src/ui/Notice.ts</code></td>
</tr>
</tbody>
</table>
<div class="callout tip" data-callout="tip"><div class="callout-title"><div class="callout-icon"></div><div class="callout-title-inner">Tip</div></div><div class="callout-content"><p>UI 层不包含业务逻辑，所有逻辑都委托给下层。</p></div></div>
<h3 id="2-插件层-plugin-layer">2. 插件层 (Plugin Layer)</h3>
<p>Friday 插件的主入口，协调各个子系统。</p>
<pre><code class="language-typescript">export default class FridayPlugin extends Plugin {
    private syncCore: FridaySyncCore | null = null;
    private publishCore: FridayPublishCore | null = null;
    
    async onload() {
        // 初始化同步核心
        this.syncCore = new FridaySyncCore(this.app, this);
        await this.syncCore.initialize(config);
        
        // 初始化发布核心
        this.publishCore = new FridayPublishCore(this.app, this);
        
        // 注册 UI 组件
        this.registerStatusBar();
        this.registerCommands();
        this.registerSettings();
    }
}
</code></pre>
<p><strong>核心职责</strong>:</p>
<ul>
<li>插件生命周期管理</li>
<li>子系统初始化和协调</li>
<li>全局事件监听</li>
</ul>
<h3 id="3-核心业务层-core-business-layer">3. 核心业务层 (Core Business Layer)</h3>
<p>实现 Friday 的核心功能。</p>
<h4 id="fridaysynccore">FridaySyncCore</h4>
<p>同步功能的中枢，协调所有同步相关的组件。</p>
<pre><code class="language-typescript">export class FridaySyncCore {
    private _replicator: LiveSyncCouchDBReplicator | null = null;
    private _localDB: FridayLocalDB | null = null;
    private _storageEventManager: FridayStorageEventManager | null = null;
    private _serverChecker: ServerConnectivityChecker | null = null;
    private _managers: FridayServiceHub | null = null;
    
    async startSync(continuous: boolean = true): Promise&#x3C;boolean> {
        // 1️⃣ 检查服务器连接性
        const connectivity = await this._serverChecker?.checkConnectivity();
        
        // 2️⃣ 根据连接状态选择策略
        if (connectivity?.status === "REACHABLE") {
            // 在线模式
            await this.startOnlineSync();
        } else {
            // 离线模式
            await this.startOfflineMode();
        }
    }
}
</code></pre>
<p><strong>关键方法</strong>:</p>
<ul>
<li><code>initialize()</code>: 初始化所有子组件</li>
<li><code>startSync()</code>: 启动同步流程</li>
<li><code>stopSync()</code>: 停止同步</li>
<li><code>handleOfflineMode()</code>: 处理离线情况</li>
</ul>
<h4 id="fridaypublishcore">FridayPublishCore</h4>
<p>发布功能的核心（未来将详细实现）。</p>
<h3 id="4-功能模块层-feature-module-layer">4. 功能模块层 (Feature Module Layer)</h3>
<p>独立的、可复用的功能模块。</p>
<pre><code>src/sync/features/
├── ServerConnectivity/      # 服务器连接性检查
├── NetworkEvents/            # 网络事件监听
├── ConnectionMonitor/        # 连接监控和重连
├── ConnectionFailure/        # 连接失败处理
└── OfflineTracker/           # 离线修改追踪
</code></pre>
<p>每个模块都是<strong>自包含</strong>的，可以独立测试和复用。</p>
<div class="callout example" data-callout="example"><div class="callout-title"><div class="callout-icon"></div><div class="callout-title-inner">功能模块示例</div></div><div class="callout-content"><p><code>ServerConnectivity</code> 模块：</p>
<ul>
<li>输入：服务器配置</li>
<li>输出：连接状态（REACHABLE/UNREACHABLE）</li>
<li>无副作用：不修改全局状态</li>
<li>可测试：可以 mock 网络请求</li>
</ul>
</div></div>
<h3 id="5-存储层-data-layer">5. 存储层 (Data Layer)</h3>
<p>负责数据的持久化和检索。</p>
<pre class="mermaid-wrapper"><code class="language-mermaid mermaid">graph LR
    subgraph "本地存储"
        FileSystem[Obsidian&#x3C;br/>文件系统]
        PouchDB[(PouchDB&#x3C;br/>IndexedDB)]
    end
    
    subgraph "远程存储"
        CouchDB[(CouchDB&#x3C;br/>服务器)]
    end
    
    FileSystem -->|变更检测| StorageEventMgr
    StorageEventMgr -->|保存| PouchDB
    PouchDB &#x3C;-->|复制| CouchDB
    
    style PouchDB fill:#f9f,stroke:#333,stroke-width:2px
</code><button class="expand-button" aria-label="Expand diagram"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"></path></svg></button><div id="mermaid-container"><div id="mermaid-space"><div class="mermaid-content"></div></div></div></pre>
<p><strong>关键组件</strong>:</p>
<table>
<thead>
<tr>
<th>组件</th>
<th>技术</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>PouchDB</td>
<td>IndexedDB 封装</td>
<td>本地数据库，存储笔记和元数据</td>
</tr>
<tr>
<td>CouchDB</td>
<td>远程数据库</td>
<td>云端存储，多设备同步</td>
</tr>
<tr>
<td>FileSystem</td>
<td>Obsidian Vault API</td>
<td>用户可见的文件系统</td>
</tr>
</tbody>
</table>
<h2 id="数据流架构">数据流架构</h2>
<h3 id="正常同步流程">正常同步流程</h3>
<pre class="mermaid-wrapper"><code class="language-mermaid mermaid">sequenceDiagram
    participant User as 用户
    participant FS as 文件系统
    participant Watcher as StorageEventManager
    participant PDB as PouchDB
    participant Rep as Replicator
    participant CDB as CouchDB
    
    User->>FS: 编辑 note.md
    FS->>Watcher: 触发 modify 事件
    Watcher->>PDB: 保存到本地
    PDB-->>Watcher: 确认
    
    Note over Rep: 持续监听 PouchDB 变更
    PDB->>Rep: 检测到新变更
    Rep->>CDB: 推送变更
    CDB-->>Rep: 确认接收
    
    Note over Rep: 定期拉取远程变更
    Rep->>CDB: 拉取变更
    CDB-->>Rep: 返回其他设备的变更
    Rep->>PDB: 保存远程变更
    PDB->>FS: 更新文件系统
    FS-->>User: 看到其他设备的更新
</code><button class="expand-button" aria-label="Expand diagram"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"></path></svg></button><div id="mermaid-container"><div id="mermaid-space"><div class="mermaid-content"></div></div></div></pre>
<h3 id="离线模式数据流">离线模式数据流</h3>
<pre class="mermaid-wrapper"><code class="language-mermaid mermaid">sequenceDiagram
    participant User as 用户
    participant FS as 文件系统
    participant Watcher as StorageEventManager
    participant PDB as PouchDB
    participant Tracker as OfflineTracker
    participant Rep as Replicator
    participant CDB as CouchDB
    
    Note over Rep: 检测到服务器不可达
    Rep->>Tracker: setOffline(true)
    
    User->>FS: 编辑 note.md
    FS->>Watcher: 触发 modify 事件
    Watcher->>PDB: 保存到本地
    Watcher->>Tracker: 记录待同步变更
    PDB-->>User: 本地保存成功
    
    Note over Rep: 10秒后尝试重连
    Rep->>CDB: 尝试连接
    CDB-->>Rep: 连接成功
    
    Rep->>Tracker: getPendingChanges()
    Tracker-->>Rep: 返回待同步列表
    Rep->>CDB: 推送所有待同步变更
    CDB-->>Rep: 确认
    Rep->>Tracker: setOffline(false)
</code><button class="expand-button" aria-label="Expand diagram"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"></path></svg></button><div id="mermaid-container"><div id="mermaid-space"><div class="mermaid-content"></div></div></div></pre>
<h2 id="核心组件详解">核心组件详解</h2>
<h3 id="livesyncreplicator">LiveSyncReplicator</h3>
<p>复制器是同步功能的核心，负责在本地 PouchDB 和远程 CouchDB 之间同步数据。</p>
<pre><code class="language-typescript">export class LiveSyncCouchDBReplicator extends LiveSyncAbstractReplicator {
    // 单次同步
    async openOneShotReplication(
        setting: RemoteDBSettings,
        showResult: boolean,
        syncMode: "sync" | "pullOnly" | "pushOnly"
    ): Promise&#x3C;boolean> {
        // 1. 确保 PBKDF2 salt
        await this.ensurePBKDF2Salt(setting);
        
        // 2. 检查 salt 一致性
        await this.checkSaltConsistency(setting);
        
        // 3. 执行同步
        await this.performReplication(syncMode);
    }
    
    // 持续同步
    async openReplication(
        setting: RemoteDBSettings,
        keepAlive: boolean,
        showResult: boolean
    ): Promise&#x3C;boolean> {
        // 启动双向实时同步
        this.startLiveReplication();
    }
}
</code></pre>
<p><strong>关键职责</strong>:</p>
<ul>
<li>PBKDF2 盐值验证</li>
<li>数据库一致性检查</li>
<li>单次/持续同步</li>
<li>冲突解决</li>
</ul>
<h3 id="fridaylocaldb">FridayLocalDB</h3>
<p>本地数据库管理器，封装 PouchDB 操作。</p>
<pre><code class="language-typescript">export class FridayLocalDB {
    private db: PouchDB.Database;
    
    // 初始化数据库
    async initializeDatabase(
        vaultName: string,
        passphrase: string
    ): Promise&#x3C;boolean> {
        this.db = new PouchDB(vaultName, {
            adapter: 'indexeddb',
            auto_compaction: true
        });
    }
    
    // CRUD 操作
    async get(id: string): Promise&#x3C;Document | null>;
    async put(doc: Document): Promise&#x3C;boolean>;
    async remove(doc: Document): Promise&#x3C;boolean>;
    
    // 批量操作
    async bulkDocs(docs: Document[]): Promise&#x3C;boolean>;
    
    // 查询
    async allDocs(options?: any): Promise&#x3C;Document[]>;
    async query(filter: any): Promise&#x3C;Document[]>;
}
</code></pre>
<h3 id="storageeventmanager">StorageEventManager</h3>
<p>文件系统监听器，检测 Obsidian vault 中的文件变更。</p>
<pre><code class="language-typescript">export class FridayStorageEventManager {
    private _isWatching = false;
    
    beginWatch() {
        this.app.vault.on('create', this.onFileCreate);
        this.app.vault.on('modify', this.onFileModify);
        this.app.vault.on('delete', this.onFileDelete);
        this.app.vault.on('rename', this.onFileRename);
        
        this._isWatching = true;
    }
    
    private async onFileModify(file: TFile) {
        // 读取文件内容
        const content = await this.app.vault.read(file);
        
        // 保存到 PouchDB
        await this.localDB.put({
            _id: file.path,
            content: content,
            mtime: file.stat.mtime
        });
    }
}
</code></pre>
<div class="callout warning" data-callout="warning"><div class="callout-title"><div class="callout-icon"></div><div class="callout-title-inner">防止循环更新</div></div><div class="callout-content"><p><code>StorageEventManager</code> 需要小心处理自己触发的文件变更，避免无限循环。</p>
</div></div>
<h3 id="serverconnectivitychecker">ServerConnectivityChecker</h3>
<p>详见 <a class="internal alias" data-slug="server-connectivity" data-wikilink="server-connectivity" href="/architecture/server-connectivity.html" data-slug="architecture/server-connectivity">服务器连接性检查</a> 文档。</p>
<h2 id="设计模式">设计模式</h2>
<p>Friday 采用了多种设计模式来提高代码质量：</p>
<h3 id="1-单例模式-singleton">1. 单例模式 (Singleton)</h3>
<pre><code class="language-typescript">export class FridaySyncCore {
    private static _instance: FridaySyncCore | null = null;
    
    static getInstance(app: App, plugin: Plugin): FridaySyncCore {
        if (!this._instance) {
            this._instance = new FridaySyncCore(app, plugin);
        }
        return this._instance;
    }
}
</code></pre>
<p><strong>用途</strong>: 确保核心组件只有一个实例。</p>
<h3 id="2-观察者模式-observer">2. 观察者模式 (Observer)</h3>
<pre><code class="language-typescript">export class ReplicationStatus {
    private observers: Array&#x3C;(status: SyncStatus) => void> = [];
    
    subscribe(callback: (status: SyncStatus) => void) {
        this.observers.push(callback);
    }
    
    notify(status: SyncStatus) {
        this.observers.forEach(cb => cb(status));
    }
}
</code></pre>
<p><strong>用途</strong>: 状态变化通知（如同步状态更新）。</p>
<h3 id="3-策略模式-strategy">3. 策略模式 (Strategy)</h3>
<pre><code class="language-typescript">interface SyncStrategy {
    sync(): Promise&#x3C;boolean>;
}

class OnlineSync implements SyncStrategy {
    async sync(): Promise&#x3C;boolean> {
        // 在线同步逻辑
    }
}

class OfflineSync implements SyncStrategy {
    async sync(): Promise&#x3C;boolean> {
        // 离线模式逻辑
    }
}

class SyncContext {
    private strategy: SyncStrategy;
    
    setStrategy(strategy: SyncStrategy) {
        this.strategy = strategy;
    }
    
    async executeSync(): Promise&#x3C;boolean> {
        return await this.strategy.sync();
    }
}
</code></pre>
<p><strong>用途</strong>: 根据网络状态选择不同的同步策略。</p>
<h3 id="4-工厂模式-factory">4. 工厂模式 (Factory)</h3>
<pre><code class="language-typescript">export class ReplicatorFactory {
    static createReplicator(
        type: 'couchdb' | 'memory',
        env: LiveSyncReplicatorEnv
    ): LiveSyncAbstractReplicator {
        switch (type) {
            case 'couchdb':
                return new LiveSyncCouchDBReplicator(env);
            case 'memory':
                return new LiveSyncMemoryReplicator(env);
            default:
                throw new Error(`Unknown replicator type: ${type}`);
        }
    }
}
</code></pre>
<p><strong>用途</strong>: 创建不同类型的复制器。</p>
<h3 id="5-适配器模式-adapter">5. 适配器模式 (Adapter)</h3>
<pre><code class="language-typescript">// Obsidian Vault API 适配器
export class VaultAdapter {
    constructor(private vault: Vault) {}
    
    // 统一的文件读取接口
    async readFile(path: string): Promise&#x3C;string> {
        const file = this.vault.getAbstractFileByPath(path);
        if (file instanceof TFile) {
            return await this.vault.read(file);
        }
        throw new Error('File not found');
    }
}
</code></pre>
<p><strong>用途</strong>: 封装 Obsidian API，便于测试和替换。</p>
<h2 id="错误处理架构">错误处理架构</h2>
<p>Friday 采用分层的错误处理策略：</p>
<pre class="mermaid-wrapper"><code class="language-mermaid mermaid">graph TD
    E1[应用层错误] --> H1[用户友好通知]
    E2[业务层错误] --> H2[日志记录 + 状态更新]
    E3[网络层错误] --> H3[重试 + 离线模式]
    E4[存储层错误] --> H4[数据恢复 + 警告]
    
    H1 --> Logger[统一日志系统]
    H2 --> Logger
    H3 --> Logger
    H4 --> Logger
</code><button class="expand-button" aria-label="Expand diagram"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"></path></svg></button><div id="mermaid-container"><div id="mermaid-space"><div class="mermaid-content"></div></div></div></pre>
<h3 id="错误类型">错误类型</h3>
<pre><code class="language-typescript">// 自定义错误类型
export class FridaySyncError extends Error {
    constructor(
        message: string,
        public code: string,
        public recoverable: boolean = true
    ) {
        super(message);
        this.name = 'FridaySyncError';
    }
}

// 具体错误
export class ServerUnreachableError extends FridaySyncError {
    constructor() {
        super('服务器不可达', 'SERVER_UNREACHABLE', true);
    }
}

export class EncryptionError extends FridaySyncError {
    constructor(message: string) {
        super(message, 'ENCRYPTION_ERROR', false);
    }
}
</code></pre>
<h3 id="错误处理策略">错误处理策略</h3>
<pre><code class="language-typescript">try {
    await this.syncOperation();
} catch (error) {
    if (error instanceof ServerUnreachableError) {
        // 可恢复错误 - 进入离线模式
        this.handleOfflineMode();
    } else if (error instanceof EncryptionError) {
        // 不可恢复错误 - 通知用户
        showNotice('加密错误: ' + error.message);
        this.setStatus('ERRORED');
    } else {
        // 未知错误 - 记录并通知
        Logger(error, LOG_LEVEL_ERROR);
        showNotice('未知错误，请查看日志');
    }
}
</code></pre>
<h2 id="性能优化">性能优化</h2>
<h3 id="1-增量同步">1. 增量同步</h3>
<p>只同步变更的部分，而不是整个数据库：</p>
<pre><code class="language-typescript">// 使用 PouchDB 的 changes feed
this.db.changes({
    since: 'now',
    live: true,
    include_docs: true
}).on('change', (change) => {
    // 只处理变更的文档
    this.handleChange(change);
});
</code></pre>
<h3 id="2-节流和防抖">2. 节流和防抖</h3>
<pre><code class="language-typescript">import { debounce } from 'lodash-es';

export class FridayStorageEventManager {
    // 防抖：文件修改后 500ms 才保存
    private onFileModify = debounce(async (file: TFile) => {
        await this.saveToLocalDB(file);
    }, 500);
}
</code></pre>
<h3 id="3-批量操作">3. 批量操作</h3>
<pre><code class="language-typescript">// 批量保存文档，减少数据库事务
async saveBatch(files: TFile[]) {
    const docs = await Promise.all(
        files.map(f => this.fileToDocument(f))
    );
    await this.db.bulkDocs(docs);
}
</code></pre>
<h3 id="4-懒加载">4. 懒加载</h3>
<pre><code class="language-typescript">// 只在需要时初始化大型组件
private _publishCore: FridayPublishCore | null = null;

get publishCore(): FridayPublishCore {
    if (!this._publishCore) {
        this._publishCore = new FridayPublishCore(this.app, this.plugin);
    }
    return this._publishCore;
}
</code></pre>
<h3 id="5-连接池和缓存">5. 连接池和缓存</h3>
<pre><code class="language-typescript">// 服务器连接性检查结果缓存 5 秒
private _lastCheckTime: number = 0;
private _lastStatus: ServerStatus = "UNKNOWN";
private _checkCooldown: number = 5000;

async checkConnectivity(): Promise&#x3C;ServerStatus> {
    const now = Date.now();
    if (now - this._lastCheckTime &#x3C; this._checkCooldown) {
        return this._lastStatus; // 返回缓存结果
    }
    // 执行实际检查
}
</code></pre>
<h2 id="安全架构">安全架构</h2>
<h3 id="1-端到端加密">1. 端到端加密</h3>
<pre class="mermaid-wrapper"><code class="language-mermaid mermaid">graph LR
    Plain[明文笔记] -->|PBKDF2| Key[加密密钥]
    Key -->|AES-256| Encrypted[加密内容]
    Encrypted -->|上传| CouchDB[(CouchDB)]
    CouchDB -->|下载| Encrypted2[加密内容]
    Encrypted2 -->|AES-256| Key2[加密密钥]
    Key2 -->|解密| Plain2[明文笔记]
    
    style Key fill:#f96,stroke:#333,stroke-width:2px
    style Key2 fill:#f96,stroke:#333,stroke-width:2px
</code><button class="expand-button" aria-label="Expand diagram"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"></path></svg></button><div id="mermaid-container"><div id="mermaid-space"><div class="mermaid-content"></div></div></div></pre>
<h3 id="2-密钥派生">2. 密钥派生</h3>
<pre><code class="language-typescript">// 使用 PBKDF2 从密码派生密钥
async deriveKey(passphrase: string, salt: string): Promise&#x3C;CryptoKey> {
    const encoder = new TextEncoder();
    const passphraseKey = await crypto.subtle.importKey(
        'raw',
        encoder.encode(passphrase),
        'PBKDF2',
        false,
        ['deriveBits', 'deriveKey']
    );
    
    return await crypto.subtle.deriveKey(
        {
            name: 'PBKDF2',
            salt: encoder.encode(salt),
            iterations: 100000,
            hash: 'SHA-256'
        },
        passphraseKey,
        { name: 'AES-GCM', length: 256 },
        true,
        ['encrypt', 'decrypt']
    );
}
</code></pre>
<h3 id="3-安全存储">3. 安全存储</h3>
<pre><code class="language-typescript">// 加密密码永不上传到服务器
// 只存储在本地（Obsidian 设置）
class EncryptionManager {
    private passphrase: string | null = null;
    
    // 从本地加载
    loadPassphrase(): string | null {
        return this.plugin.settings.encryptionPassphrase;
    }
    
    // 保存到本地
    savePassphrase(passphrase: string) {
        this.plugin.settings.encryptionPassphrase = passphrase;
        this.plugin.saveSettings();
    }
}
</code></pre>
<div class="callout danger" data-callout="danger"><div class="callout-title"><div class="callout-icon"></div><div class="callout-title-inner">安全警告</div></div><div class="callout-content"><ul>
<li>密码存储在本地的 Obsidian 设置文件中（未加密）</li>
<li>不要在不信任的设备上使用</li>
<li>定期更新密码</li>
</ul>
</div></div>
<h2 id="测试架构">测试架构</h2>
<h3 id="单元测试">单元测试</h3>
<pre><code class="language-typescript">// 使用 Jest 进行单元测试
describe('ServerConnectivityChecker', () => {
    it('should return REACHABLE when server responds', async () => {
        const checker = new ServerConnectivityChecker();
        const result = await checker.checkConnectivity(mockSettings);
        expect(result.status).toBe('REACHABLE');
    });
    
    it('should return UNREACHABLE when server is down', async () => {
        const checker = new ServerConnectivityChecker();
        fetchMock.mockReject(new Error('Connection failed'));
        const result = await checker.checkConnectivity(mockSettings);
        expect(result.status).toBe('UNREACHABLE');
    });
});
</code></pre>
<h3 id="集成测试">集成测试</h3>
<pre><code class="language-typescript">// 测试完整的同步流程
describe('Sync Flow Integration', () => {
    it('should sync file from device A to device B', async () => {
        const deviceA = createTestDevice('A');
        const deviceB = createTestDevice('B');
        
        // 设备 A 创建文件
        await deviceA.vault.create('test.md', 'Hello World');
        
        // 等待同步
        await wait(2000);
        
        // 设备 B 应该看到文件
        const file = await deviceB.vault.read('test.md');
        expect(file).toBe('Hello World');
    });
});
</code></pre>
<h3 id="e2e-测试">E2E 测试</h3>
<p>使用 Playwright 进行端到端测试：</p>
<pre><code class="language-typescript">test('offline mode should save changes locally', async ({ page }) => {
    // 登录
    await page.goto('http://localhost:3000');
    await login(page);
    
    // 断网
    await page.context().setOffline(true);
    
    // 编辑文件
    await page.fill('#editor', 'Offline edit');
    
    // 恢复网络
    await page.context().setOffline(false);
    
    // 等待同步
    await page.waitForSelector('.sync-success');
    
    // 验证另一设备能看到
    await verifyOnOtherDevice('Offline edit');
});
</code></pre>
<h2 id="监控和日志">监控和日志</h2>
<h3 id="日志系统">日志系统</h3>
<pre><code class="language-typescript">export enum LogLevel {
    VERBOSE = 10,  // 详细调试信息
    INFO = 20,     // 一般信息
    NOTICE = 30,   // 用户可见通知
    WARN = 40,     // 警告
    ERROR = 50     // 错误
}

export function Logger(
    message: string,
    level: LogLevel = LogLevel.INFO,
    metadata?: any
) {
    const timestamp = new Date().toISOString();
    const prefix = `[Friday ${LogLevel[level]}]`;
    
    console.log(`${timestamp} ${prefix} ${message}`, metadata);
    
    // 发送到远程监控（如果配置）
    if (level >= LogLevel.ERROR) {
        sendToMonitoring(message, level, metadata);
    }
}
</code></pre>
<h3 id="性能监控">性能监控</h3>
<pre><code class="language-typescript">class PerformanceMonitor {
    measure(name: string, fn: () => Promise&#x3C;any>): Promise&#x3C;any> {
        const start = performance.now();
        return fn().finally(() => {
            const duration = performance.now() - start;
            Logger(`${name} took ${duration.toFixed(2)}ms`, LOG_LEVEL_VERBOSE);
        });
    }
}

// 使用
await perfMonitor.measure('sync', () => this.startSync());
</code></pre>
<h2 id="可扩展性">可扩展性</h2>
<p>Friday 设计时考虑了未来的扩展：</p>
<h3 id="1-插件系统规划中">1. 插件系统（规划中）</h3>
<pre><code class="language-typescript">interface FridayPlugin {
    name: string;
    version: string;
    onLoad(): Promise&#x3C;void>;
    onUnload(): Promise&#x3C;void>;
}

class PluginManager {
    private plugins: Map&#x3C;string, FridayPlugin> = new Map();
    
    async loadPlugin(plugin: FridayPlugin) {
        await plugin.onLoad();
        this.plugins.set(plugin.name, plugin);
    }
}
</code></pre>
<h3 id="2-存储后端抽象">2. 存储后端抽象</h3>
<pre><code class="language-typescript">interface StorageBackend {
    save(id: string, content: string): Promise&#x3C;void>;
    load(id: string): Promise&#x3C;string>;
    sync(): Promise&#x3C;void>;
}

class CouchDBBackend implements StorageBackend {
    // CouchDB 实现
}

class S3Backend implements StorageBackend {
    // S3 实现
}
</code></pre>
<h3 id="3-认证提供者">3. 认证提供者</h3>
<pre><code class="language-typescript">interface AuthProvider {
    authenticate(credentials: any): Promise&#x3C;AuthToken>;
    refresh(token: AuthToken): Promise&#x3C;AuthToken>;
}

class LicenseAuthProvider implements AuthProvider {
    // License Key 认证
}

class OAuth2Provider implements AuthProvider {
    // OAuth2 认证
}
</code></pre>
<h2 id="相关文档">相关文档</h2>
<ul>
<li><a class="internal alias" data-slug="sync-internals" data-wikilink="sync-internals" href="/sync-internals.html" data-slug="sync-internals">同步机制内部原理</a></li>
<li><a class="internal alias" data-slug="security-model" data-wikilink="security-model" href="/security-model.html" data-slug="security-model">安全模型</a></li>
<li><a class="internal alias" data-slug="data-flow" data-wikilink="data-flow" href="/data-flow.html" data-slug="data-flow">数据流和存储架构</a></li>
<li><a class="internal alias" data-slug="server-connectivity" data-wikilink="server-connectivity" href="/architecture/server-connectivity.html" data-slug="architecture/server-connectivity">服务器连接性检查</a></li>
<li><a class="internal alias" data-slug="offline-mode" data-wikilink="offline-mode" href="/sync/offline-mode.html" data-slug="sync/offline-mode">离线模式</a></li>
</ul>
<h2 id="技术栈">技术栈</h2>
<table>
<thead>
<tr>
<th>层次</th>
<th>技术</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>前端框架</td>
<td>Obsidian Plugin API</td>
<td>插件开发</td>
</tr>
<tr>
<td>UI 框架</td>
<td>Preact / Svelte</td>
<td>设置面板组件</td>
</tr>
<tr>
<td>状态管理</td>
<td>RxJS</td>
<td>响应式状态管理</td>
</tr>
<tr>
<td>本地数据库</td>
<td>PouchDB</td>
<td>IndexedDB 封装</td>
</tr>
<tr>
<td>远程数据库</td>
<td>CouchDB</td>
<td>云端同步</td>
</tr>
<tr>
<td>加密</td>
<td>Web Crypto API</td>
<td>端到端加密</td>
</tr>
<tr>
<td>网络请求</td>
<td>Fetch API</td>
<td>HTTP 请求</td>
</tr>
<tr>
<td>构建工具</td>
<td>esbuild</td>
<td>快速构建</td>
</tr>
<tr>
<td>测试框架</td>
<td>Jest + Playwright</td>
<td>单元和 E2E 测试</td>
</tr>
<tr>
<td>类型检查</td>
<td>TypeScript</td>
<td>类型安全</td>
</tr>
<tr>
<td>代码检查</td>
<td>ESLint</td>
<td>代码质量</td>
</tr>
</tbody>
</table>
<h2 id="开发指南">开发指南</h2>
<p>想要贡献代码或开发扩展？查看这些资源：</p>
<ul>
<li><a href="/development-setup.html" class="internal alias" data-slug="development-setup">开发环境设置</a></li>
<li><a href="/coding-standards.html" class="internal alias" data-slug="coding-standards">代码规范</a></li>
<li><a href="/contributing.html" class="internal alias" data-slug="contributing">提交指南</a></li>
<li><a href="/api-reference.html" class="internal alias" data-slug="api-reference">API 文档</a></li>
</ul>

    </div>
</article>

            </div>
            
            
            <aside class="sidebar right"><div class="graph">
  <h3>关系图谱</h3>
  <div class="graph-outer">
    <div class="graph-container" data-cfg='{"drag":true,"zoom":true,"depth":1,"scale":1.1,"repelForce":0.5,"centerForce":0.3,"linkDistance":30,"fontSize":0.6,"opacityScale":1,"showTags":true,"removeTags":[],"focusOnHover":false,"enableRadial":false}'></div>
    <button class="global-graph-icon" aria-label="全局图谱" title="全局图谱">
      <svg
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        x="0px"
        y="0px"
        viewBox="0 0 55 55"
        fill="currentColor"
        xml:space="preserve"
      >
        <path
          d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
          s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
          c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
          C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
          c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
          v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
          s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
          C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
          S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
          s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
          s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"
        />
      </svg>
    </button>
  </div>
  <div class="global-graph-outer">
    <div class="global-graph-container" data-cfg='{"drag":true,"zoom":true,"depth":-1,"scale":0.9,"repelForce":0.5,"centerForce":0.2,"linkDistance":30,"fontSize":0.6,"opacityScale":1,"showTags":true,"removeTags":[],"focusOnHover":true,"enableRadial":true}'></div>
  </div>
</div>

<div class="toc desktop-only">
    <button type="button" 
            class="toc-header" 
            aria-controls="toc-content"
            aria-expanded="true">
        <h3>目录</h3>
        <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="fold">
            <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
    </button>
    <div id="toc-content" class="toc-content">
        <!-- Quartz 源码: OverflowList 使用 ul.overflow 包装 -->
        <ul class="overflow" id="toc-list">
            <ul>
  <li><a href="#系统架构总览">系统架构总览</a></li>
  <li><a href="#分层架构">分层架构</a>
    <ul>
  <li><a href="#1-用户界面层-presentation-layer">1. 用户界面层 (Presentation Layer)</a></li>
  <li><a href="#2-插件层-plugin-layer">2. 插件层 (Plugin Layer)</a></li>
  <li><a href="#3-核心业务层-core-business-layer">3. 核心业务层 (Core Business Layer)</a>
    <ul>
  <li><a href="#fridaysynccore">FridaySyncCore</a></li>
  <li><a href="#fridaypublishcore">FridayPublishCore</a></li>    </ul></li>
  <li><a href="#4-功能模块层-feature-module-layer">4. 功能模块层 (Feature Module Layer)</a></li>
  <li><a href="#5-存储层-data-layer">5. 存储层 (Data Layer)</a></li>    </ul></li>
  <li><a href="#数据流架构">数据流架构</a>
    <ul>
  <li><a href="#正常同步流程">正常同步流程</a></li>
  <li><a href="#离线模式数据流">离线模式数据流</a></li>    </ul></li>
  <li><a href="#核心组件详解">核心组件详解</a>
    <ul>
  <li><a href="#livesyncreplicator">LiveSyncReplicator</a></li>
  <li><a href="#fridaylocaldb">FridayLocalDB</a></li>
  <li><a href="#storageeventmanager">StorageEventManager</a></li>
  <li><a href="#serverconnectivitychecker">ServerConnectivityChecker</a></li>    </ul></li>
  <li><a href="#设计模式">设计模式</a>
    <ul>
  <li><a href="#1-单例模式-singleton">1. 单例模式 (Singleton)</a></li>
  <li><a href="#2-观察者模式-observer">2. 观察者模式 (Observer)</a></li>
  <li><a href="#3-策略模式-strategy">3. 策略模式 (Strategy)</a></li>
  <li><a href="#4-工厂模式-factory">4. 工厂模式 (Factory)</a></li>
  <li><a href="#5-适配器模式-adapter">5. 适配器模式 (Adapter)</a></li>    </ul></li>
  <li><a href="#错误处理架构">错误处理架构</a>
    <ul>
  <li><a href="#错误类型">错误类型</a></li>
  <li><a href="#错误处理策略">错误处理策略</a></li>    </ul></li>
  <li><a href="#性能优化">性能优化</a>
    <ul>
  <li><a href="#1-增量同步">1. 增量同步</a></li>
  <li><a href="#2-节流和防抖">2. 节流和防抖</a></li>
  <li><a href="#3-批量操作">3. 批量操作</a></li>
  <li><a href="#4-懒加载">4. 懒加载</a></li>
  <li><a href="#5-连接池和缓存">5. 连接池和缓存</a></li>    </ul></li>
  <li><a href="#安全架构">安全架构</a>
    <ul>
  <li><a href="#1-端到端加密">1. 端到端加密</a></li>
  <li><a href="#2-密钥派生">2. 密钥派生</a></li>
  <li><a href="#3-安全存储">3. 安全存储</a></li>    </ul></li>
  <li><a href="#测试架构">测试架构</a>
    <ul>
  <li><a href="#单元测试">单元测试</a></li>
  <li><a href="#集成测试">集成测试</a></li>
  <li><a href="#e2e-测试">E2E 测试</a></li>    </ul></li>
  <li><a href="#监控和日志">监控和日志</a>
    <ul>
  <li><a href="#日志系统">日志系统</a></li>
  <li><a href="#性能监控">性能监控</a></li>    </ul></li>
  <li><a href="#可扩展性">可扩展性</a>
    <ul>
  <li><a href="#1-插件系统规划中">1. 插件系统（规划中）</a></li>
  <li><a href="#2-存储后端抽象">2. 存储后端抽象</a></li>
  <li><a href="#3-认证提供者">3. 认证提供者</a></li>    </ul></li>
  <li><a href="#相关文档">相关文档</a></li>
  <li><a href="#技术栈">技术栈</a></li>
  <li><a href="#开发指南">开发指南</a></li></ul>

            <!-- Quartz 源码: overflow-end 用于 IntersectionObserver 检测滚动底部 -->
            <li class="overflow-end"></li>
        </ul>
    </div>
</div><div class="backlinks">
    <h3>反向链接</h3>
    <ul class="overflow"><li>
                <a href="/friday.html" class="internal">
                    关于 Friday
                </a>
            </li><li>
                <a href="/get-started.html" class="internal">
                    快速开始
                </a>
            </li><li>
                <a href="/sync/intro.html" class="internal">
                    简介
                </a>
            </li></ul>
</div></aside>
            
            <footer>
    <p>
        构建于 
        <a href="https://github.com/mdfriday">MDFriday</a>
        <br/> © 2026 All Rights Reserved.
    </p>
  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-9MFZLCQBM2"></script>
      <script>
        var doNotTrack = false;
        if (false) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-9MFZLCQBM2');
        }
      </script>
    
  


    
</footer>

</div>
    </div>
<script src="/js/darkmode.js" defer></script>
<script src="/js/readermode.js" defer></script>
<script src="/js/toc.js" defer></script>
<script src="/js/explorer.js" defer></script>
<script src="/js/clipboard.js" defer></script>
<script src="/js/callout.js" defer></script>


<script src="https://cdn.jsdelivr.net/npm/flexsearch@0.7.31/dist/flexsearch.bundle.js" defer></script>


<script defer src="/zh.search.min.74af685e8249.js"></script>


<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>


<script src="https://cdn.jsdelivr.net/npm/pixi.js@8.0.0/dist/pixi.min.js"></script>


<script src="/js/graph.js" defer></script>


<script src="https://cdn.jsdelivr.net/npm/@floating-ui/core@1.5.0/dist/floating-ui.core.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.5.3/dist/floating-ui.dom.umd.min.js"></script>


<script src="/js/popover.js" defer></script>


<script>
window.__FOUNDRY_PAGES__ = [
    {
        "slug": "categories",
        "displayPath": "categories",
        "url": "/categories/index.html",
        "title": "category"
    },{
        "slug": "publish/intro",
        "displayPath": "publish/intro",
        "url": "/publish/intro.html",
        "title": "介绍"
    },{
        "slug": "tags",
        "displayPath": "tags",
        "url": "/tags/index.html",
        "title": "tag"
    },{
        "slug": "tags/hugo",
        "displayPath": "tags/hugo",
        "url": "/tags/hugo/index.html",
        "title": "hugo"
    },{
        "slug": "tags/主题",
        "displayPath": "tags/主题",
        "url": "/tags/主题/index.html",
        "title": "主题"
    },{
        "slug": "tags/买断",
        "displayPath": "tags/买断",
        "url": "/tags/买断/index.html",
        "title": "买断"
    },{
        "slug": "tags/产品",
        "displayPath": "tags/产品",
        "url": "/tags/产品/index.html",
        "title": "产品"
    },{
        "slug": "tags/企业",
        "displayPath": "tags/企业",
        "url": "/tags/企业/index.html",
        "title": "企业"
    },{
        "slug": "tags/作品集",
        "displayPath": "tags/作品集",
        "url": "/tags/作品集/index.html",
        "title": "作品集"
    },{
        "slug": "tags/分享",
        "displayPath": "tags/分享",
        "url": "/tags/分享/index.html",
        "title": "分享"
    },{
        "slug": "tags/功能",
        "displayPath": "tags/功能",
        "url": "/tags/功能/index.html",
        "title": "功能"
    },{
        "slug": "tags/加密",
        "displayPath": "tags/加密",
        "url": "/tags/加密/index.html",
        "title": "加密"
    },{
        "slug": "tags/博客",
        "displayPath": "tags/博客",
        "url": "/tags/博客/index.html",
        "title": "博客"
    },{
        "slug": "tags/发布",
        "displayPath": "tags/发布",
        "url": "/tags/发布/index.html",
        "title": "发布"
    },{
        "slug": "tags/同步",
        "displayPath": "tags/同步",
        "url": "/tags/同步/index.html",
        "title": "同步"
    },{
        "slug": "tags/域名",
        "displayPath": "tags/域名",
        "url": "/tags/域名/index.html",
        "title": "域名"
    },{
        "slug": "tags/多站点",
        "displayPath": "tags/多站点",
        "url": "/tags/多站点/index.html",
        "title": "多站点"
    },{
        "slug": "tags/子域名",
        "displayPath": "tags/子域名",
        "url": "/tags/子域名/index.html",
        "title": "子域名"
    },{
        "slug": "tags/安全",
        "displayPath": "tags/安全",
        "url": "/tags/安全/index.html",
        "title": "安全"
    },{
        "slug": "tags/市场营销",
        "displayPath": "tags/市场营销",
        "url": "/tags/市场营销/index.html",
        "title": "市场营销"
    },{
        "slug": "tags/常见问题",
        "displayPath": "tags/常见问题",
        "url": "/tags/常见问题/index.html",
        "title": "常见问题"
    },{
        "slug": "tags/快速开始",
        "displayPath": "tags/快速开始",
        "url": "/tags/快速开始/index.html",
        "title": "快速开始"
    },{
        "slug": "tags/技术",
        "displayPath": "tags/技术",
        "url": "/tags/技术/index.html",
        "title": "技术"
    },{
        "slug": "tags/指南",
        "displayPath": "tags/指南",
        "url": "/tags/指南/index.html",
        "title": "指南"
    },{
        "slug": "tags/文件冲突",
        "displayPath": "tags/文件冲突",
        "url": "/tags/文件冲突/index.html",
        "title": "文件冲突"
    },{
        "slug": "tags/文档",
        "displayPath": "tags/文档",
        "url": "/tags/文档/index.html",
        "title": "文档"
    },{
        "slug": "tags/架构",
        "displayPath": "tags/架构",
        "url": "/tags/架构/index.html",
        "title": "架构"
    },{
        "slug": "tags/激活",
        "displayPath": "tags/激活",
        "url": "/tags/激活/index.html",
        "title": "激活"
    },{
        "slug": "tags/激活码",
        "displayPath": "tags/激活码",
        "url": "/tags/激活码/index.html",
        "title": "激活码"
    },{
        "slug": "tags/知识库",
        "displayPath": "tags/知识库",
        "url": "/tags/知识库/index.html",
        "title": "知识库"
    },{
        "slug": "tags/离线",
        "displayPath": "tags/离线",
        "url": "/tags/离线/index.html",
        "title": "离线"
    },{
        "slug": "tags/简介",
        "displayPath": "tags/简介",
        "url": "/tags/简介/index.html",
        "title": "简介"
    },{
        "slug": "tags/简历",
        "displayPath": "tags/简历",
        "url": "/tags/简历/index.html",
        "title": "简历"
    },{
        "slug": "tags/网络",
        "displayPath": "tags/网络",
        "url": "/tags/网络/index.html",
        "title": "网络"
    },{
        "slug": "tags/自定义",
        "displayPath": "tags/自定义",
        "url": "/tags/自定义/index.html",
        "title": "自定义"
    },{
        "slug": "tags/设置",
        "displayPath": "tags/设置",
        "url": "/tags/设置/index.html",
        "title": "设置"
    },{
        "slug": "tags/重置",
        "displayPath": "tags/重置",
        "url": "/tags/重置/index.html",
        "title": "重置"
    },{
        "slug": "tags/预览",
        "displayPath": "tags/预览",
        "url": "/tags/预览/index.html",
        "title": "预览"
    },{
        "slug": "publish/quick-share",
        "displayPath": "publish/quick-share",
        "url": "/publish/quick-share.html",
        "title": "快速分享"
    },{
        "slug": "publish/right-panel",
        "displayPath": "publish/right-panel",
        "url": "/publish/right-panel.html",
        "title": "右侧面板"
    },{
        "slug": "publish",
        "displayPath": "publish",
        "url": "/publish/index.html",
        "title": "发布"
    },{
        "slug": "publish/preview",
        "displayPath": "publish/preview",
        "url": "/publish/preview.html",
        "title": "本地预览"
    },{
        "slug": "publish/site-path",
        "displayPath": "publish/site-path",
        "url": "/publish/site-path.html",
        "title": "多站点指南"
    },{
        "slug": "architecture",
        "displayPath": "architecture",
        "url": "/architecture/index.html",
        "title": "架构"
    },{
        "slug": "architecture/overview",
        "displayPath": "architecture/overview",
        "url": "/architecture/overview.html",
        "title": "架构概览"
    },{
        "slug": "architecture/server-connectivity",
        "displayPath": "architecture/server-connectivity",
        "url": "/architecture/server-connectivity.html",
        "title": "服务器连接性检查"
    },{
        "slug": "faq",
        "displayPath": "faq",
        "url": "/faq.html",
        "title": "常见问题"
    },{
        "slug": "friday",
        "displayPath": "friday",
        "url": "/friday.html",
        "title": "关于 Friday"
    },{
        "slug": "get-started",
        "displayPath": "get-started",
        "url": "/get-started.html",
        "title": "快速开始"
    },{
        "slug": "license",
        "displayPath": "license",
        "url": "/license/index.html",
        "title": "激活码"
    },{
        "slug": "license/activation",
        "displayPath": "license/activation",
        "url": "/license/activation.html",
        "title": "激活"
    },{
        "slug": "license/custom",
        "displayPath": "license/custom",
        "url": "/license/custom.html",
        "title": "Friday 私有化部署服务"
    },{
        "slug": "publish/custom-domain",
        "displayPath": "publish/custom-domain",
        "url": "/publish/custom-domain.html",
        "title": "自定义域名"
    },{
        "slug": "publish/subdomain",
        "displayPath": "publish/subdomain",
        "url": "/publish/subdomain.html",
        "title": "二级域名发布"
    },{
        "slug": "sync",
        "displayPath": "sync",
        "url": "/sync/index.html",
        "title": "同步"
    },{
        "slug": "sync/confilict",
        "displayPath": "sync/confilict",
        "url": "/sync/confilict.html",
        "title": "同步问题排查"
    },{
        "slug": "sync/encryption",
        "displayPath": "sync/encryption",
        "url": "/sync/encryption.html",
        "title": "加密"
    },{
        "slug": "sync/intro",
        "displayPath": "sync/intro",
        "url": "/sync/intro.html",
        "title": "简介"
    },{
        "slug": "sync/offline-mode",
        "displayPath": "sync/offline-mode",
        "url": "/sync/offline-mode.html",
        "title": "离线模式"
    },{
        "slug": "sync/reset",
        "displayPath": "sync/reset",
        "url": "/sync/reset.html",
        "title": "重置"
    },{
        "slug": "sync/settings",
        "displayPath": "sync/settings",
        "url": "/sync/settings.html",
        "title": "设置"
    },{
        "slug": "themes",
        "displayPath": "themes",
        "url": "/themes/index.html",
        "title": "主题"
    },{
        "slug": "themes/blog",
        "displayPath": "themes/blog",
        "url": "/themes/blog.html",
        "title": "博客"
    },{
        "slug": "themes/community",
        "displayPath": "themes/community",
        "url": "/themes/community.html",
        "title": "社区"
    },{
        "slug": "themes/document",
        "displayPath": "themes/document",
        "url": "/themes/document.html",
        "title": "文档"
    },{
        "slug": "themes/intro",
        "displayPath": "themes/intro",
        "url": "/themes/intro.html",
        "title": "简介"
    },{
        "slug": "themes/landing",
        "displayPath": "themes/landing",
        "url": "/themes/landing.html",
        "title": "产品官网"
    },{
        "slug": "themes/portfolio",
        "displayPath": "themes/portfolio",
        "url": "/themes/portfolio.html",
        "title": "作品集"
    },{
        "slug": "themes/resume",
        "displayPath": "themes/resume",
        "url": "/themes/resume.html",
        "title": "简历"
    },{
        "slug": "themes/wiki",
        "displayPath": "themes/wiki",
        "url": "/themes/wiki.html",
        "title": "知识库"
    },{
        "slug": "index",
        "displayPath": "index",
        "url": "/index.html",
        "title": "欢迎使用 Friday"
    }];



window.__FOUNDRY_CONTENT_INDEX__ = {
    "categories": {
        "slug": "categories",
        "title": "category",
        "links": [],
        "tags": []
    },"publish/intro": {
        "slug": "publish/intro",
        "title": "介绍",
        "links": [],
        "tags": ["tags/发布","tags/简介"]
    },"tags": {
        "slug": "tags",
        "title": "tag",
        "links": [],
        "tags": []
    },"tags/hugo": {
        "slug": "tags/hugo",
        "title": "hugo",
        "links": [],
        "tags": []
    },"tags/主题": {
        "slug": "tags/主题",
        "title": "主题",
        "links": [],
        "tags": []
    },"tags/买断": {
        "slug": "tags/买断",
        "title": "买断",
        "links": [],
        "tags": []
    },"tags/产品": {
        "slug": "tags/产品",
        "title": "产品",
        "links": [],
        "tags": []
    },"tags/企业": {
        "slug": "tags/企业",
        "title": "企业",
        "links": [],
        "tags": []
    },"tags/作品集": {
        "slug": "tags/作品集",
        "title": "作品集",
        "links": [],
        "tags": []
    },"tags/分享": {
        "slug": "tags/分享",
        "title": "分享",
        "links": [],
        "tags": []
    },"tags/功能": {
        "slug": "tags/功能",
        "title": "功能",
        "links": [],
        "tags": []
    },"tags/加密": {
        "slug": "tags/加密",
        "title": "加密",
        "links": [],
        "tags": []
    },"tags/博客": {
        "slug": "tags/博客",
        "title": "博客",
        "links": [],
        "tags": []
    },"tags/发布": {
        "slug": "tags/发布",
        "title": "发布",
        "links": [],
        "tags": []
    },"tags/同步": {
        "slug": "tags/同步",
        "title": "同步",
        "links": [],
        "tags": []
    },"tags/域名": {
        "slug": "tags/域名",
        "title": "域名",
        "links": [],
        "tags": []
    },"tags/多站点": {
        "slug": "tags/多站点",
        "title": "多站点",
        "links": [],
        "tags": []
    },"tags/子域名": {
        "slug": "tags/子域名",
        "title": "子域名",
        "links": [],
        "tags": []
    },"tags/安全": {
        "slug": "tags/安全",
        "title": "安全",
        "links": [],
        "tags": []
    },"tags/市场营销": {
        "slug": "tags/市场营销",
        "title": "市场营销",
        "links": [],
        "tags": []
    },"tags/常见问题": {
        "slug": "tags/常见问题",
        "title": "常见问题",
        "links": [],
        "tags": []
    },"tags/快速开始": {
        "slug": "tags/快速开始",
        "title": "快速开始",
        "links": [],
        "tags": []
    },"tags/技术": {
        "slug": "tags/技术",
        "title": "技术",
        "links": [],
        "tags": []
    },"tags/指南": {
        "slug": "tags/指南",
        "title": "指南",
        "links": [],
        "tags": []
    },"tags/文件冲突": {
        "slug": "tags/文件冲突",
        "title": "文件冲突",
        "links": [],
        "tags": []
    },"tags/文档": {
        "slug": "tags/文档",
        "title": "文档",
        "links": [],
        "tags": []
    },"tags/架构": {
        "slug": "tags/架构",
        "title": "架构",
        "links": [],
        "tags": []
    },"tags/激活": {
        "slug": "tags/激活",
        "title": "激活",
        "links": [],
        "tags": []
    },"tags/激活码": {
        "slug": "tags/激活码",
        "title": "激活码",
        "links": [],
        "tags": []
    },"tags/知识库": {
        "slug": "tags/知识库",
        "title": "知识库",
        "links": [],
        "tags": []
    },"tags/离线": {
        "slug": "tags/离线",
        "title": "离线",
        "links": [],
        "tags": []
    },"tags/简介": {
        "slug": "tags/简介",
        "title": "简介",
        "links": [],
        "tags": []
    },"tags/简历": {
        "slug": "tags/简历",
        "title": "简历",
        "links": [],
        "tags": []
    },"tags/网络": {
        "slug": "tags/网络",
        "title": "网络",
        "links": [],
        "tags": []
    },"tags/自定义": {
        "slug": "tags/自定义",
        "title": "自定义",
        "links": [],
        "tags": []
    },"tags/设置": {
        "slug": "tags/设置",
        "title": "设置",
        "links": [],
        "tags": []
    },"tags/重置": {
        "slug": "tags/重置",
        "title": "重置",
        "links": [],
        "tags": []
    },"tags/预览": {
        "slug": "tags/预览",
        "title": "预览",
        "links": [],
        "tags": []
    },"publish/quick-share": {
        "slug": "publish/quick-share",
        "title": "快速分享",
        "links": [],
        "tags": ["tags/分享","tags/发布"]
    },"publish/right-panel": {
        "slug": "publish/right-panel",
        "title": "右侧面板",
        "links": [],
        "tags": ["tags/发布"]
    },"publish": {
        "slug": "publish",
        "title": "发布",
        "links": [],
        "tags": []
    },"publish/preview": {
        "slug": "publish/preview",
        "title": "本地预览",
        "links": [],
        "tags": ["tags/预览","tags/发布"]
    },"publish/site-path": {
        "slug": "publish/site-path",
        "title": "多站点指南",
        "links": [],
        "tags": ["tags/多站点","tags/发布"]
    },"architecture": {
        "slug": "architecture",
        "title": "架构",
        "links": [],
        "tags": []
    },"architecture/overview": {
        "slug": "architecture/overview",
        "title": "架构概览",
        "links": ["architecture/server-connectivity","sync-internals","security-model","data-flow","sync/offline-mode","development-setup","coding-standards","contributing","api-reference"],
        "tags": ["tags/技术","tags/架构"]
    },"architecture/server-connectivity": {
        "slug": "architecture/server-connectivity",
        "title": "服务器连接性检查",
        "links": ["sync/offline-mode","MDFriday/help/content/sync/encryption","sync/reset","architecture/sync-internals"],
        "tags": ["tags/网络","tags/架构","tags/同步"]
    },"faq": {
        "slug": "faq",
        "title": "常见问题",
        "links": ["friday","sync/encryption","sync/offline-mode"],
        "tags": ["tags/常见问题"]
    },"friday": {
        "slug": "friday",
        "title": "关于 Friday",
        "links": ["sync/encryption","sync/offline-mode","sync/server-connectivity","sync/intro","publish/quick-share","publish/subdomain","publish/custom-domain","publish/enterprise-domain企业域名","themes/wiki","themes/document","themes/blog","themes/portfolio","themes/resume","themes/ppt","themes/landing","themes/enterprise","themes/community","publish/preview","architecture/overview","architecture/security-model"],
        "tags": ["tags/简介"]
    },"get-started": {
        "slug": "get-started",
        "title": "快速开始",
        "links": ["[淘宝购买](https:/item.taobao.com/item.htmid=1021681636191-and-mi_id=0000TP6GHQep6drq4_kU9DP4zK01apQ5i_06dEQlgeN7KZI-and-skuId=6196046574887-and-spm=a21xtw.29178619.0.0-and-xxc=shop)","license/activation","sync/settings","publish/quick-share","themes/community","publish/subdomain","publish/custom-domain","friday","architecture/overview","sync/server-connectivity","sync/offline-mode","publish/enterprise-domain","license/custom"],
        "tags": ["tags/快速开始","tags/指南"]
    },"license": {
        "slug": "license",
        "title": "激活码",
        "links": [],
        "tags": []
    },"license/activation": {
        "slug": "license/activation",
        "title": "激活",
        "links": ["get-started"],
        "tags": ["tags/激活码","tags/激活"]
    },"license/custom": {
        "slug": "license/custom",
        "title": "Friday 私有化部署服务",
        "links": [],
        "tags": ["tags/企业","tags/买断","tags/激活码"]
    },"publish/custom-domain": {
        "slug": "publish/custom-domain",
        "title": "自定义域名",
        "links": ["publish/site-path"],
        "tags": ["tags/域名","tags/自定义","tags/发布"]
    },"publish/subdomain": {
        "slug": "publish/subdomain",
        "title": "二级域名发布",
        "links": ["themes/community","publish/preview","publish/custom-domain","publish/quick-share"],
        "tags": ["tags/子域名","tags/域名","tags/发布"]
    },"sync": {
        "slug": "sync",
        "title": "同步",
        "links": [],
        "tags": []
    },"sync/confilict": {
        "slug": "sync/confilict",
        "title": "同步问题排查",
        "links": ["sync/offline-mode"],
        "tags": ["tags/文件冲突","tags/同步"]
    },"sync/encryption": {
        "slug": "sync/encryption",
        "title": "加密",
        "links": [],
        "tags": ["tags/安全","tags/加密","tags/同步"]
    },"sync/intro": {
        "slug": "sync/intro",
        "title": "简介",
        "links": ["sync/encryption","sync/offline-mode","architecture/server-connectivity","sync/settings","license/activation","architecture/overview","license/custom","publish/quick-share"],
        "tags": ["tags/简介","tags/同步"]
    },"sync/offline-mode": {
        "slug": "sync/offline-mode",
        "title": "离线模式",
        "links": ["sync/reset"],
        "tags": ["tags/功能","tags/离线","tags/同步"]
    },"sync/reset": {
        "slug": "sync/reset",
        "title": "重置",
        "links": [],
        "tags": ["tags/重置","tags/同步"]
    },"sync/settings": {
        "slug": "sync/settings",
        "title": "设置",
        "links": [],
        "tags": ["tags/同步","tags/设置"]
    },"themes": {
        "slug": "themes",
        "title": "主题",
        "links": [],
        "tags": []
    },"themes/blog": {
        "slug": "themes/blog",
        "title": "博客",
        "links": [],
        "tags": ["tags/博客","tags/主题"]
    },"themes/community": {
        "slug": "themes/community",
        "title": "社区",
        "links": ["publish/preview","publish/quick-share","showcases/awesome","themes/wiki","themes/blog","themes/document","themes/portfolio","friday","get-started","license/activation"],
        "tags": ["tags/主题","tags/hugo"]
    },"themes/document": {
        "slug": "themes/document",
        "title": "文档",
        "links": [],
        "tags": ["tags/文档","tags/主题"]
    },"themes/intro": {
        "slug": "themes/intro",
        "title": "简介",
        "links": ["publish/preview"],
        "tags": ["tags/简介","tags/主题"]
    },"themes/landing": {
        "slug": "themes/landing",
        "title": "产品官网",
        "links": [],
        "tags": ["tags/市场营销","tags/产品","tags/主题"]
    },"themes/portfolio": {
        "slug": "themes/portfolio",
        "title": "作品集",
        "links": [],
        "tags": ["tags/作品集","tags/主题"]
    },"themes/resume": {
        "slug": "themes/resume",
        "title": "简历",
        "links": [],
        "tags": ["tags/简历","tags/主题"]
    },"themes/wiki": {
        "slug": "themes/wiki",
        "title": "知识库",
        "links": [],
        "tags": ["tags/知识库","tags/主题"]
    },"index": {
        "slug": "index",
        "title": "欢迎使用 Friday",
        "links": ["get-started","friday","faq","license/activation","license/custom","sync/settings","sync/intro","sync/encryption","sync/offline-mode","sync/server-connectivity","themes/community","themes/wiki","themes/document","themes/blog","themes/portfolio","themes/resume","themes/ppt","themes/landing","themes/enterprise","publish/quick-share","publish/subdomain","publish/custom-domain","publish/enterprise-domain","publish/preview","publish/wysiwyg","architecture/overview"],
        "tags": []
    }};


window.__FOUNDRY_BASE_URL_PATH__ = "";


console.log('[Explorer] Loaded pages:', window.__FOUNDRY_PAGES__.length);
console.log('[Explorer] Base URL path:', "");
console.log('[Graph] Loaded content index:', Object.keys(window.__FOUNDRY_CONTENT_INDEX__).length);
console.log('[Graph] Injected __FOUNDRY_BASE_URL_PATH__:', window.__FOUNDRY_BASE_URL_PATH__);
</script>


</body>
</html>

